(this["webpackJsonpjamesroberts.github.io"]=this["webpackJsonpjamesroberts.github.io"]||[]).push([[4],{29:function(e,t,n){"use strict";n.r(t);var r=n(7),c=n(0),o=(n(62),n(63)),a=n.n(o),i=n(93),s=n(65),u=n(94),l=n(66),d=n.n(l),p=n(113),f=n(111),j=n(68),b=n.n(j);function h(e){var t,n="100%",c="100%";return e.peerStreams.length>0&&(n="".concat(100/e.peerStreams.length,"%"),c="".concat(100/e.peerStreams.length,"%")),Object(r.jsxs)("div",{style:{position:"relative",top:0,right:0,marginBottom:25,marginTop:25},children:[Object(r.jsx)("ul",{children:null===(t=e.peerStreams)||void 0===t?void 0:t.map((function(e){return Object(r.jsx)("li",{children:Object(r.jsx)(b.a,{url:e,playing:!0,width:n,height:c})},e.id)}))}),Object(r.jsx)("div",{style:{position:"absolute",top:0,right:0},children:Object(r.jsx)(b.a,{url:e.userStream,playing:!0,width:"25%",height:"25%"})})]})}var g=n(114),O=n(89),v=n.n(O),x=n(91),m=n.n(x),k=n(1);function S(){var e=Object(c.useState)(""),t=Object(u.a)(e,2),n=t[0],o=t[1],l=Object(c.useState)(new d.a),j=Object(u.a)(l,2),b=j[0],O=(j[1],Object(c.useState)("")),x=Object(u.a)(O,2),S=x[0],w=x[1],y=Object(c.useState)(!1),E=Object(u.a)(y,2),C=E[0],D=E[1],T=Object(c.useState)(null),U=Object(u.a)(T,2),M=U[0],z=U[1],N=Object(c.useState)(null),P=Object(u.a)(N,2),L=P[0],V=P[1],A=Object(c.useState)([]),B=Object(u.a)(A,2),F=B[0],I=B[1],J=Object(c.useState)(null),_=Object(u.a)(J,2),G=_[0],H=_[1],R=Object(c.useState)(!1),Y=Object(u.a)(R,2),q=Y[0],K=Y[1];var Q=new URLSearchParams(Object(k.d)().search).get("friend");function W(e){o(e)}function X(e){e=ne(e),z(e),w(e.peer)}function Z(){return $.apply(this,arguments)}function $(){return($=Object(s.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={audio:!1,video:!0},e.prev=1,!q){e.next=8;break}return e.next=5,navigator.mediaDevices.getDisplayMedia(t);case 5:n=e.sent,e.next=11;break;case 8:return e.next=10,navigator.mediaDevices.getUserMedia(t);case 10:n=e.sent;case 11:return e.abrupt("return",n);case 14:e.prev=14,e.t0=e.catch(1),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[1,14]])})))).apply(this,arguments)}function ee(e){return te.apply(this,arguments)}function te(){return(te=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w(t.peer),e.next=3,Z();case 3:(n=e.sent)&&(H(n),t.answer(n),t=re(t),V(t));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(e){return e.on("open",(function(){console.log("Connected opened with peer: "+e.peer)})),e.on("data",(function(e){console.log(e)})),e.on("close",(function(){var t;console.log("Connection closed."),console.log(G),t=e.peer,null===F||void 0===F||F.forEach((function(e){e.id===t&&(e.getTracks().forEach((function(e){return e.stop()})),e.getVideoTracks().forEach((function(e){return e.stop()})))})),I((function(e){return e.filter((function(e){return e.id!==t}))})),0==F.length&&ce()})),e.on("error",(function(e){console.log(e)})),e}function re(e){return e.on("stream",(function(e){return I((function(t){return[].concat(Object(i.a)(t),[e])}))})),e.on("error",(function(e){return console.log(e)})),e}function ce(){G&&(G.getTracks().forEach((function(e){return e.stop()})),G.getVideoTracks().forEach((function(e){return e.stop()})),console.log("User stream tracks stopped")),F&&(F.forEach((function(e){e.getTracks().forEach((function(e){return e.stop()})),e.getVideoTracks().forEach((function(e){return e.stop()}))})),console.log("Peer streams stopped")),H(null),V(null),I((function(){return[]}))}function oe(){var e=b.connect(S);e=ne(e),z(e)}function ae(){return(ae=Object(s.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!q){e.next=7;break}return e.next=4,navigator.mediaDevices.getDisplayMedia({audio:!1,video:!0});case 4:t=e.sent,e.next=10;break;case 7:return e.next=9,navigator.mediaDevices.getUserMedia({audio:!1,video:!0});case 9:t=e.sent;case 10:n=re(n=b.call(S,t)),V(n),H(t),oe(),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),console.log(e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})))).apply(this,arguments)}Q&&""===S&&w(Q),Object(c.useEffect)((function(){b.on("open",W),b.on("connection",X),b.on("call",ee),console.log("Peer initialized")}),[b]),Object(c.useEffect)((function(){console.log(G)}),[G]);return Object(r.jsxs)("div",{children:[Object(r.jsx)(p.a,{onChange:function(e){return w(e.target.value)},placeholder:"Caller ID"}),Object(r.jsxs)(f.a,{variant:"contained",color:"primary",onClick:function(){return ae.apply(this,arguments)},style:{margin:10},children:[" ",Object(r.jsx)(v.a,{fontSize:"large"})," "]}),Object(r.jsxs)(f.a,{variant:"contained",color:"primary",onClick:function(){if(n){var e=window.location.protocol+"//"+window.location.host+"/?friend="+n;navigator.clipboard.writeText("Hey Friend! Give me a call using this link :\n"+e),D(!0)}},children:[" ",Object(r.jsx)(m.a,{fontSize:"large"})," "]}),C?Object(r.jsx)("div",{style:{fontSize:15,color:"green"},children:"Link copied to clipboard"}):null,Object(r.jsx)("br",{}),Object(r.jsx)(g.a,{checked:q,onChange:function(e){K(e.target.checked)},color:"primary",name:"checkedB",inputProps:{"aria-label":"primary checkbox"}})," Share Screen",Object(r.jsxs)("div",{children:["Your Caller ID: "+n,Object(r.jsx)("br",{}),""!==S?"Connecting to: "+S:null]}),Object(r.jsx)(h,{peerStreams:F,userStream:G}),Object(r.jsx)("div",{children:L?Object(r.jsx)(f.a,{variant:"contained",color:"secondary",onClick:function(){null===L||void 0===L||L.close(),null===M||void 0===M||M.close(),V(null),ce(),w("")},children:" Disconnect "}):null})]})}t.default=function(){return Object(r.jsx)("div",{className:"App",children:Object(r.jsx)("header",{className:"App-header",children:Object(r.jsx)(S,{})})})}},62:function(e,t,n){},67:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=67}}]);
//# sourceMappingURL=4.61a6474a.chunk.js.map